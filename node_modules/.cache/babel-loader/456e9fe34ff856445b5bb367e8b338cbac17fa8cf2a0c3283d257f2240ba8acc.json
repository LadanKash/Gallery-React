{"ast":null,"code":"var _s = $RefreshSig$();\nimport { getDownloadURL, ref, uploadBytesResumable } from \"firebase/storage\";\nimport { useEffect, useState } from \"react\";\nimport { db, storage } from \"../firebase/config\";\nimport { addDoc, collection, serverTimestamp } from \"firebase/firestore\";\nexport const useStorage = file => {\n  _s();\n  const [progress, setProgress] = useState(0);\n  const [error, setError] = useState(null);\n  const [url, setUrl] = useState(null);\n  useEffect(() => {\n    // references\n    const storageRef = ref(storage, file.name);\n    const uploadTask = uploadBytesResumable(storageRef, file);\n    const collectionRef = collection(db, 'images');\n    const unsub = uploadTask.on('state_changed', snapshot => {\n      const precentage = snapshot.bytesTransferred / snapshot.totalBytes * 100;\n      setProgress(precentage);\n    }, err => {\n      setError(err);\n    }, async () => {\n      const downloadURL = await getDownloadURL(storageRef);\n      setUrl(downloadURL);\n      const createdAt = serverTimestamp();\n      await addDoc(collectionRef, {\n        url: downloadURL,\n        createdAt\n      });\n    });\n    return () => unsub();\n  }, [file]);\n  return {\n    progress,\n    url,\n    error\n  };\n};\n_s(useStorage, \"xn2AiAzche7NzWswJ7VS1PhvjkU=\");","map":{"version":3,"names":["getDownloadURL","ref","uploadBytesResumable","useEffect","useState","db","storage","addDoc","collection","serverTimestamp","useStorage","file","_s","progress","setProgress","error","setError","url","setUrl","storageRef","name","uploadTask","collectionRef","unsub","on","snapshot","precentage","bytesTransferred","totalBytes","err","downloadURL","createdAt"],"sources":["C:/Users/lkash/Desktop/Gallery/src/hooks/useStorage.js"],"sourcesContent":["import { getDownloadURL, ref, uploadBytesResumable } from \"firebase/storage\"\r\nimport { useEffect, useState } from \"react\"\r\nimport { db, storage } from \"../firebase/config\"\r\nimport { addDoc, collection, serverTimestamp } from \"firebase/firestore\"\r\n\r\n\r\nexport const useStorage = (file) => {\r\n    const [progress, setProgress] = useState(0)\r\n    const [error, setError] = useState(null)\r\n    const [url, setUrl] = useState(null)\r\n\r\n    useEffect(() => {\r\n\r\n        // references\r\n        const storageRef = ref(storage, file.name)\r\n        const uploadTask = uploadBytesResumable(storageRef, file)\r\n        \r\n        const collectionRef = collection(db, 'images')\r\n\r\n        const unsub = uploadTask.on('state_changed', (snapshot) => {\r\n            const precentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100\r\n            setProgress(precentage)\r\n        }, (err) => {\r\n            setError(err)\r\n        }, async () => {\r\n            const downloadURL = await getDownloadURL(storageRef)\r\n            setUrl(downloadURL)\r\n\r\n            const createdAt = serverTimestamp()\r\n\r\n            await addDoc(collectionRef, {url: downloadURL, createdAt})\r\n        })\r\n\r\n        return () => unsub()\r\n        \r\n    }, [file])\r\n\r\n    return {progress, url, error}\r\n}"],"mappings":";AAAA,SAASA,cAAc,EAAEC,GAAG,EAAEC,oBAAoB,QAAQ,kBAAkB;AAC5E,SAASC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,EAAE,EAAEC,OAAO,QAAQ,oBAAoB;AAChD,SAASC,MAAM,EAAEC,UAAU,EAAEC,eAAe,QAAQ,oBAAoB;AAGxE,OAAO,MAAMC,UAAU,GAAIC,IAAI,IAAK;EAAAC,EAAA;EAChC,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGV,QAAQ,CAAC,CAAC,CAAC;EAC3C,MAAM,CAACW,KAAK,EAAEC,QAAQ,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACa,GAAG,EAAEC,MAAM,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EAEpCD,SAAS,CAAC,MAAM;IAEZ;IACA,MAAMgB,UAAU,GAAGlB,GAAG,CAACK,OAAO,EAAEK,IAAI,CAACS,IAAI,CAAC;IAC1C,MAAMC,UAAU,GAAGnB,oBAAoB,CAACiB,UAAU,EAAER,IAAI,CAAC;IAEzD,MAAMW,aAAa,GAAGd,UAAU,CAACH,EAAE,EAAE,QAAQ,CAAC;IAE9C,MAAMkB,KAAK,GAAGF,UAAU,CAACG,EAAE,CAAC,eAAe,EAAGC,QAAQ,IAAK;MACvD,MAAMC,UAAU,GAAID,QAAQ,CAACE,gBAAgB,GAAGF,QAAQ,CAACG,UAAU,GAAI,GAAG;MAC1Ed,WAAW,CAACY,UAAU,CAAC;IAC3B,CAAC,EAAGG,GAAG,IAAK;MACRb,QAAQ,CAACa,GAAG,CAAC;IACjB,CAAC,EAAE,YAAY;MACX,MAAMC,WAAW,GAAG,MAAM9B,cAAc,CAACmB,UAAU,CAAC;MACpDD,MAAM,CAACY,WAAW,CAAC;MAEnB,MAAMC,SAAS,GAAGtB,eAAe,CAAC,CAAC;MAEnC,MAAMF,MAAM,CAACe,aAAa,EAAE;QAACL,GAAG,EAAEa,WAAW;QAAEC;MAAS,CAAC,CAAC;IAC9D,CAAC,CAAC;IAEF,OAAO,MAAMR,KAAK,CAAC,CAAC;EAExB,CAAC,EAAE,CAACZ,IAAI,CAAC,CAAC;EAEV,OAAO;IAACE,QAAQ;IAAEI,GAAG;IAAEF;EAAK,CAAC;AACjC,CAAC;AAAAH,EAAA,CAhCYF,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}